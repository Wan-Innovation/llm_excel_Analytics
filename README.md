# ExcelLLM: 基于大模型的Excel数据分析

## 📊 项目概述

ExcelLLM实现基于自然语言的表格数据分析。本项目通过创新的预处理、语义理解和结果生成技术，解决了LLM处理表格数据的局限性。

## 🌟 核心功能

- **结构化数据理解**：将Excel表格转换为txt格式，便于LLM理解
- **可视化表格数据选择**：根据查询需求灵活确定数据范围
- **上下文管理**：根据数据量，灵活确定数据分块，大模型将先按分块总结，再合并归纳。
- **本地或API选项**：选择本地大模型或API

## 🤔 背景描述

大型语言模型在处理Excel数据时面临几个挑战：

1. **格式不匹配**：LLM训练于非结构化文本，而Excel数据严格按行列结构化
2. **上下文长度限制**：实战中的Excel数据轻易超过模型的令牌限制（如64K令牌）
3. **数值推理能力**：LLM进行表格分析时需要借助Python代码先做数据筛选，对于自动化分析数据还不能有效满足用户需求
4. **全局与局部分析**：当前针对大数据或本地化数据，借助RAG，但实战中分析数据需要做总体分析，而不是检索出部分数据。

## 🔄 工作流程

1. **输入**：用户上传Excel文件并提出自然语言问题
2. **预处理**：系统分析Excel结构，提取架构并识别关键元素
3. **查询分析**：对数据进行分块，满足大模型上下文长度限制
4. **LLM处理**：将提示与选定数据发送给LLM
5. **响应**：用户接收带有支持数据的综合答案

## 💡 创新方法

### 超越向量搜索

虽然Milvus等向量数据库在语义搜索方面功能强大，但它们在Excel数据分析方面证明不足，主要有两个原因：

1. **全局分析限制**：向量搜索擅长检索特定数据点，但在全局趋势分析方面表现不佳
2. **检索不精确**：搜索结构化条件（如"2020-2025年F地区枣的销售金额"）会返回语义相似但不精确匹配的数据

此项目的方法还是回归到原始，使用data+query的方式，将复杂问题简单化。

## 🚀 快速开始

### 安装

```bash
git clone https://github.com/yourusername/excel-llm.git
cd excel-llm
pip install -r requirements.txt

在终端执行 streamlit run excel_app.py

‘’‘
## 📋 系统要求

- Python 3.8+
- OpenAI API密钥或其他兼容的LLM提供商
- 所需Python包（见requirements.txt）

## 🔍 应用场景

- 销售和财务数据分析
- 商业智能和报告
- 数据探索和发现
- 高管仪表板创建
- 基于Excel的决策支持

## 🔮 未来工作

- 与更多LLM提供商集成
- 增强可视化功能
- 专门为Excel数据微调模型
- 协作分析功能
- 实时Excel集成

## 🤝 贡献

欢迎贡献！请随时提交Pull Request。

## 📄 许可证

本项目采用MIT许可证 - 详情请参阅LICENSE文件。

## 📬 联系方式

如有问题或反馈，请开issue或联系[your-email@example.com]。

---

*ExcelLLM: 为电子表格分析带来自然语言智能。* 
```

 